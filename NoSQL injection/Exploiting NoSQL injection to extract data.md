[Try it yourself before continuing](https://portswigger.net/web-security/nosql-injection/lab-nosql-injection-extract-data)

![](./Images/Pasted%20image%2020241116134852.png)

---

So this one was a little tricky As always we start with a legitimate request. we can see detail information of the user `wiener`

![](./Images/Pasted%20image%2020241116125626.png)

We need to figure out what characters are processed to generate an error or unexpected behavior let's try `'+'` encode it to URL

![](./Images/Pasted%20image%2020241116130419.png)

After detecting the vulnerability, the next step is to determine if we can influence the boolean conditions by sending two true and false queries and observing the server behavior.

![](./Images/Pasted%20image%2020241116130707.png)

![](./Images/Pasted%20image%2020241116130721.png)

Since the application behaves differently, this suggests that the false condition impacts the query logic rather than injecting this style of syntax impacts a server-side request.

> This demonstrates that you can trigger different responses for true and false conditions.

Now that we have identified that we can influence boolean conditions, we can attempt to override existing conditions to exploit the vulnerability.

> by Injecting a JavaScript condition that always evaluates to true

![](./Images/Pasted%20image%2020241116131038.png)

Since the injected condition is still true, the modified query returns all items and we get a new user `administrator`

![](./Images/Pasted%20image%2020241116131435.png)

Let's try to recover information about this new user, including his password. Let's first try to know the length of this password.

![](./Images/Pasted%20image%2020241116132223.png)

the response retrieves the account details for the administrator user. This indicates that the condition is true because the password is less than 30 characters.

> Our we have use the payload `' && 1 && 'x` which is a condition to check something true
> So:  `administrator' && this.password.length < 30 && 'x`

Let's try to know the number of characters by reducing the value by 30

![](./Images/Pasted%20image%2020241116132741.png)

> Note that when you submit the value 9, you retrieve the account details for the administrator user, but when you submit the value 8, you get an error message because the condition is false. This indicates that the password is 8 characters long.

Select `Send to Intruder`

```
administrator' && this.password[0] == 'a
```

![](./Images/Pasted%20image%2020241116133752.png)

![](./Images/Pasted%20image%2020241116133611.png)

![](./Images/Pasted%20image%2020241116133814.png)

Start the attack

![](./Images/Pasted%20image%2020241116134321.png)

this gives `qnqtfbhw` which is the administrator password.

We can test with burp

![](./Images/Pasted%20image%2020241116134603.png)

Log in as administrator user using the password listed. The lab is solved.

![](./Images/Pasted%20image%2020241116134751.png)
